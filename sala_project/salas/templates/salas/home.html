{% extends 'salas/base.html' %}

{% block content %}
<section style="display: grid; grid-template-columns: minmax(0, 2fr) minmax(0, 1.4fr); gap: 24px; align-items: center; margin-bottom: 28px;">
    <div>
        <h1 style="font-size: 2rem; margin-bottom: 8px;">Gestión de Salas de Estudio</h1>
        <p style="color: #9ca3af; margin-bottom: 16px; max-width: 540px;">
            Sistema web para la reserva y administración de salas de estudio de la Biblioteca ITID.
            Permite registrar salas, controlar su disponibilidad y gestionar las reservas de forma centralizada.
        </p>
        <div style="display: flex; flex-wrap: wrap; gap: 10px; align-items: center;">
            <a href="{% url 'reservar_sala' %}" class="btn-admin">Reservar una sala ahora</a>
            <span style="font-size: 0.85rem; color: #9ca3af;">
                Máximo 2 horas por reserva · Estado actualizado en tiempo real.
            </span>
        </div>
    </div>

    <div style="background: radial-gradient(circle at top, rgba(56,189,248,0.12), rgba(15,23,42,0.9)); border-radius: 16px; padding: 18px 18px 14px; border: 1px solid rgba(148,163,184,0.35); box-shadow: 0 18px 45px rgba(15,23,42,0.9);">
        <h3 style="margin: 0 0 10px; font-size: 1rem;">Resumen rápido</h3>
        <div style="display: grid; grid-template-columns: repeat(3, minmax(0, 1fr)); gap: 10px; font-size: 0.83rem;">
            <div style="background: rgba(15,23,42,0.9); border-radius: 10px; padding: 10px; border: 1px solid rgba(148,163,184,0.35);">
                <span style="display:block; color:#9ca3af;">Salas registradas</span>
                <strong style="font-size: 1.2rem;">{{ total_salas }}</strong>
            </div>
            <div style="background: rgba(15,23,42,0.9); border-radius: 10px; padding: 10px; border: 1px solid rgba(34,197,94,0.6);">
                <span style="display:block; color:#9ca3af;">Disponibles</span>
                <strong style="font-size: 1.2rem;">{{ salas_disponibles }}</strong>
            </div>
            <div style="background: rgba(15,23,42,0.9); border-radius: 10px; padding: 10px; border: 1px solid rgba(248,113,113,0.6);">
                <span style="display:block; color:#9ca3af;">Administrador</span>
                {% if user.is_authenticated and user.is_staff %}
                    <span style="color:#4ade80;">Sesión iniciada</span>
                {% else %}
                    <span style="color:#f97373;">Pendiente de login</span>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<h2 style="font-size: 1.25rem; margin-bottom: 8px;">Salas de estudio</h2>
<p style="color: #9ca3af; font-size: 0.9rem; margin-bottom: 10px;">
    Selecciona una sala para ver su detalle y la información de reservas activas.
</p>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(230px, 1fr)); gap: 16px; margin-top: 12px;">
    {% for sala in salas %}
        <article style="background: rgba(15,23,42,0.9); border-radius: 14px; padding: 14px 14px 12px; border: 1px solid rgba(148,163,184,0.3); box-shadow: 0 12px 25px rgba(15,23,42,0.8);">
            <header style="display:flex; justify-content:space-between; align-items:center; margin-bottom:6px;">
                <h3 style="margin:0; font-size:1rem;">{{ sala.nombre }}</h3>
                {% if sala.disponible %}
                    <span class="badge badge-ok">Disponible</span>
                {% else %}
                    <span class="badge badge-bad">Reservada</span>
                {% endif %}
            </header>
            <p style="margin:0 0 6px; font-size:0.9rem; color:#9ca3af;">
                Capacidad máxima: <strong>{{ sala.capacidad_maxima }}</strong> personas.
            </p>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:4px;">
                <a href="{% url 'detalle_sala' sala.id %}" class="btn-admin-outline">Ver detalle</a>
                <a href="{% url 'reservar_sala' %}" class="btn-admin" style="padding:4px 10px; font-size:0.8rem;">Reservar</a>
            </div>
        </article>
    {% empty %}
        <p>No hay salas registradas aún. Ingrese al panel de administración para crearlas.</p>
    {% endfor %}
</div>
{% endblock %}
